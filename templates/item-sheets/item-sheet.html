<form class="{{cssClass}} flexcol" autocomplete="off">
  <header class="sheet-header">
    <img class="profile-img" src="{{item.img}}" title="{{item.name}}" height="64" width="64"/>
    <div class="header-fields">
      <h1 class="charname"><input name="name" type="text" value="{{item.name}}" placeholder="Item Name"/></h1>
    </div>
  </header>

  <section class="sheet-body">
    {{#if (eq item.type "weapon")}}
      <div class="form-group">
        <label>Type</label>
        <select name="system.basic.type">
          <option value="melee" {{#if (eq system.basic.type "melee")}}selected{{/if}}>Melee</option>
          <option value="ranged" {{#if (eq system.basic.type "ranged")}}selected{{/if}}>Ranged</option>
        </select>
      </div>
      <div class="form-group">
        <label>Attack Bonus</label>
        <input type="number" name="system.basic.attackBonus" value="{{system.basic.attackBonus}}" data-dtype="Number"/>
      </div>
      <div class="form-group">
        <label>Damage</label>
        <input type="text" name="system.basic.damage" value="{{system.basic.damage}}" placeholder="e.g., 1d4+1"/>
      </div>
      <div class="form-group">
        <label>Damage Type</label>
        <select name="system.basic.damageType" {{#if weaponDamageTypeLocked}}disabled{{/if}}>
          <option value="Acid" {{#if (eq system.basic.damageType "Acid")}}selected{{/if}}>Acid</option>
          <option value="Chaos" {{#if (eq system.basic.damageType "Chaos")}}selected{{/if}}>Chaos</option>
          <option value="Cold" {{#if (eq system.basic.damageType "Cold")}}selected{{/if}}>Cold</option>
          <option value="Fire" {{#if (eq system.basic.damageType "Fire")}}selected{{/if}}>Fire</option>
          <option value="Kinetic" {{#if (eq system.basic.damageType "Kinetic")}}selected{{/if}}>Kinetic</option>
          <option value="Lightning" {{#if (eq system.basic.damageType "Lightning")}}selected{{/if}}>Lightning</option>
          <option value="Necrotic" {{#if (eq system.basic.damageType "Necrotic")}}selected{{/if}}>Necrotic</option>
          <option value="Photonic" {{#if (eq system.basic.damageType "Photonic")}}selected{{/if}}>Photonic</option>
          <option value="Poison" {{#if (eq system.basic.damageType "Poison")}}selected{{/if}}>Poison</option>
          <option value="Psychic" {{#if (eq system.basic.damageType "Psychic")}}selected{{/if}}>Psychic</option>
          <option value="Radiant" {{#if (eq system.basic.damageType "Radiant")}}selected{{/if}}>Radiant</option>
          <option value="Sonic" {{#if (eq system.basic.damageType "Sonic")}}selected{{/if}}>Sonic</option>
          <option value="Energy" {{#if (eq system.basic.damageType "Energy")}}selected{{/if}}>Energy</option>
        </select>
        {{#if weaponDamageTypeLocked}}
        <p style="font-size: 11px; color: #a0aec0; margin-top: 5px;">Locked by damage type conversion modification.</p>
        {{/if}}
      </div>
      <div class="form-group">
        <label>Range</label>
        <input type="text" name="system.basic.range" value="{{system.basic.range}}" placeholder="Melee or range"/>
      </div>
      <div class="form-group">
        <label>Hands</label>
        <input type="number" name="system.basic.hands" value="{{system.basic.hands}}" data-dtype="Number" min="1" max="2"/>
      </div>
      <div class="form-group">
        <label>Energy Cost</label>
        <input type="number" name="system.basic.energyCost" value="{{system.basic.energyCost}}" data-dtype="Number" min="1"/>
      </div>
      <div class="form-group">
        <label>Weapon Categories (comma-separated)</label>
        <input type="text" name="system.basic.categories" value="{{system.basic.categories}}" placeholder="e.g., Light Melee Weapons, Thrown Weapons"/>
        <p style="font-size: 11px; color: #a0aec0; margin-top: 5px;">Used for competence matching. Separate multiple categories with commas.</p>
      </div>
      <div class="form-group">
        <label>Modifications</label>
        <div class="mods-row">
          <button type="button" class="weapon-add-mod">Add Modification</button>
        </div>
        <div class="mods-list">
          {{#if system.basic.modifications}}
          {{#each system.basic.modifications as |mod|}}
          <div class="mod-item">
            <div class="mod-info">
              <span class="mod-name">{{mod.displayName}}</span>
              {{#if mod.displayDetail}}
              <span class="mod-detail">{{mod.displayDetail}}</span>
              {{/if}}
            </div>
            <button type="button" class="weapon-remove-mod" data-mod-id="{{mod.id}}">Remove</button>
          </div>
          {{/each}}
          {{else}}
          <div class="mod-empty">No modifications applied.</div>
          {{/if}}
        </div>
      </div>
    {{/if}}

    {{#if (eq item.type "armor")}}
      <div class="form-group">
        <label>Base AC</label>
        <input type="number" name="system.basic.baseAC" value="{{system.basic.baseAC}}" data-dtype="Number"/>
      </div>
      <div class="form-group">
        <label>Type</label>
        <select name="system.basic.type">
          <option value="light" {{#if (eq system.basic.type "light")}}selected{{/if}}>Light</option>
          <option value="medium" {{#if (eq system.basic.type "medium")}}selected{{/if}}>Medium</option>
          <option value="heavy" {{#if (eq system.basic.type "heavy")}}selected{{/if}}>Heavy</option>
        </select>
      </div>
      <div class="form-group">
        <label>Agility Cap</label>
        <input type="number" name="system.basic.agilityCap" value="{{system.basic.agilityCap}}" data-dtype="Number" placeholder="No cap"/>
      </div>
      <div class="form-group">
        <label>Might Requirement</label>
        <input type="number" name="system.basic.mightRequirement" value="{{system.basic.mightRequirement}}" data-dtype="Number" placeholder="None"/>
      </div>
      <div class="form-group">
        <label>Traits</label>
        <div class="traits-row">
          <label class="trait-checkbox">
            <input type="checkbox" class="armor-trait-input trait-toggle" name="armorTraitBulky" {{checked system.basic.traitsBulky}}/>
            <span>Bulky</span>
          </label>
          <label class="trait-field">
            <span>Stealthy</span>
            <input type="number" class="armor-trait-input" name="armorTraitStealthy" value="{{system.basic.traitsStealthyValue}}" min="1" placeholder="Value"/>
          </label>
          <label class="trait-field">
            <span>Noisy</span>
            <input type="number" class="armor-trait-input" name="armorTraitNoisy" value="{{system.basic.traitsNoisyValue}}" min="1" placeholder="Value"/>
          </label>
          <label class="trait-field">
            <span>Sealed</span>
            <input type="text" class="armor-trait-input" name="armorTraitSealed" value="{{system.basic.traitsSealedValue}}" placeholder="Time"/>
          </label>
        </div>
      </div>
      <div class="form-group">
        <label>Modifications</label>
        <div class="mods-row">
          <button type="button" class="armor-add-mod">Add Modification</button>
        </div>
        <div class="mods-list">
          {{#if system.basic.modifications}}
          {{#each system.basic.modifications as |mod|}}
          <div class="mod-item">
            <div class="mod-info">
              <span class="mod-name">{{mod.displayName}}</span>
              {{#if mod.displayDetail}}
              <span class="mod-detail">{{mod.displayDetail}}</span>
              {{/if}}
            </div>
            <button type="button" class="armor-remove-mod" data-mod-id="{{mod.id}}">Remove</button>
          </div>
          {{/each}}
          {{else}}
          <div class="mod-empty">No modifications applied.</div>
          {{/if}}
        </div>
      </div>
    {{/if}}

    {{#if (eq item.type "talent")}}
      {{#unless isGadgetItem}}
      <div class="form-group">
        <label>Type</label>
        <select name="system.basic.type">
          <option value="generic" {{#if (eq system.basic.type "generic")}}selected{{/if}}>Generic</option>
          <option value="powerset" {{#if (eq system.basic.type "powerset")}}selected{{/if}}>Powerset</option>
        </select>
      </div>
      <div class="form-group">
        <label>Prerequisites</label>
        <input type="text" name="system.basic.prerequisites" value="{{system.basic.prerequisites}}" placeholder="Prerequisites"/>
      </div>
      {{/unless}}
    {{/if}}

    {{#if (eq item.type "equipment")}}
      <div class="form-group">
        <label>Quantity</label>
        <input type="number" name="system.basic.quantity" value="{{system.basic.quantity}}" data-dtype="Number"/>
      </div>
    {{/if}}

    <div class="form-group">
      <label>Description</label>
      {{editor enrichedDescription target="system.description" button=true owner=owner editable=editable}}
    </div>
  </section>
</form>
